<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <title>OS Labs Recline Map View by oslabs</title>

  <link rel="stylesheet" href="stylesheets/styles.css">
  <link rel="stylesheet" href="stylesheets/pygment_trac.css">
  <script src="javascripts/scale.fix.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- you do not have to use bootstrap but we use it by default -->
  <link rel="stylesheet" href="https://raw.github.com/okfn/recline/master/vendor/bootstrap/2.0.2/css/bootstrap.css"/>
  <!-- CSS for relevant view components - here we just have grid -->
  <link rel="stylesheet" href="https://raw.github.com/okfn/recline/master/css/grid.css"/>

  <link rel="stylesheet" href="https://raw.github.com/okfn/recline/master/css/slickgrid.css">

  <!-- OS Map View deps -->
  <link rel="stylesheet" href="css/osmap.css">

  <style>
    #mapview {
      width: 650px;
      height: 300px;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    .olTileImage {
      border: none;
    }

    #chicken img {
      position: inherit;
      margin: inherit;
      max-width: inherit;
      padding: inherit;
      border: inherit;
    }
  </style>

</head>
<body>
  <div class="wrapper">
    <header>
      <h1 class="header">OS Labs Recline Map View </h1>

      <p class="header">Ordnance Survey map view alternative for Recline</p>

      <ul>
        <li class="download">
          <a class="buttons" href="https://github.com/oslabs/osrecline/zipball/master">Download ZIP</a></li>
        <li class="download">
          <a class="buttons" href="https://github.com/oslabs/osrecline/tarball/master">Download TAR</a></li>
        <li><a class="buttons github" href="https://github.com/oslabs/osrecline">View On GitHub</a></li>
      </ul>

      <p class="header">This project is maintained by
        <a class="header name" href="https://github.com/oslabs">oslabs</a></p>

      <p class="header">
        <a href="https://twitter.com/share" class="twitter-share-button" data-lang="en">Tweet</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        <!-- Place this tag where you want the +1 button to render. -->
      <div class="g-plusone" data-annotation="none"></div>

      <!-- Place this tag after the last +1 button tag. -->
      <script type="text/javascript">
        (function() {
          var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
          po.src = 'https://apis.google.com/js/plusone.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
      </script>
      </p>


    </header>
    <section>
      <h3>Ordnance Survey Map View</h3>

      <p>
        This is a small project to add Ordnance Survey mapping to the Recline JS data vis library. It supports the three
        types of map stack currently available (see
        <a href="http://www.ordnancesurvey.co.uk/oswebsite/web-services/os-openspace/api/index.html">http://www.ordnancesurvey.co.uk/oswebsite/web-services/os-openspace/api/index.html</a>)
        and is available from <a href="https://github.com/oslabs/osrecline">https://github.com/oslabs/osrecline</a>
      </p>
      <ul>
        <li>Open Space free</li>
        <li>Open Space Pro</li>
        <li>Open Space Pro Consistent Style</li>
      </ul>

      <p>
        For more details about the different stacks, refer to the link above.
      </p>

      <h3>Demo</h3>

      <p>
        The following demo shows some school data (from data.gov.uk) loaded onto an Open Spaces Map (free map stack).
      </p>
      <!-- 650px -->
      <div id="mapview"></div>

      <h3>Usage</h3>

      <p>
        Embedding and using the view is fairly simple - first up add the javascript dependencies:
      </p>

        <pre><code>&lt;script type="text/javascript" src="vendor/openlayers/2.12/OpenLayers.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="src/view.osmap.js"&gt;&lt;/script&gt;</code></pre>

      <p>
        Then define your dataset in the usual way and create a new <code>OSMap</code> instance:
      </p>

        <pre><code>var $el = $('#mapview');

var map = new recline.View.OSMap({
  model:dataset,
  state:{
    oskey:'SOMEKEY',
    autoZoom:true,
    theme:'vendor/openlayers/theme/dark/'
  }
});

$el.append(map.el);

map.render();
map.show();</code></pre>

      <p>
        <strong>Note the
          <code>map.show()</code> call is required at the moment</strong>. We used OpenLayers as the mapping provider
        vendor, but because of the way it does it's thing, that call to <code>show()</code> is needed. We're working
        on getting it removed to be more like the regular MapView implementation.
      </p>

      <h3>State Options</h3>
      <dl>
        <dt><code>geomField</code></dt>
        <dd>The name of the geometry field in the data containing GeoJSON, If not set, will be derived if possible</dd>
        <dt><code>eastingField</code></dt>
        <dd> name of the field containing the 'easting' value. If not set, will be derived if possible</dd>
        <dt><code>northingField</code></dt>
        <dd> name of the field containing the 'northing' value. If not set, will be derived if possible</dd>
        <dt><code>autoZoom</code></dt>
        <dd>if true (the default), will zoom to contain all the data points</dd>
        <dt><code>oskey</code></dt>
        <dd> Ordnance Survey Openspace key - if not set, will cause an exception to be thrown</dd>
        <dt><code>osstack</code></dt>
        <dd> map stack to be used, one of OSF (default), OSP, OSCS - more on this below</dd>
        <dt><code>withPanZoomBar</code></dt>
        <dd>boolean indicating if the Pan And Zoom bar should be drawn</dd>
        <dt><code>theme</code></dt>
        <dd>Theme path which contains imagery etc for controls and popups, default is 'vendor/openlayers/theme/dark/'</dd>
      </dl>

      <h3>Map Stacks</h3>

      <p>There are three main map stacks available to applications, one free and two paid for. Details of the different
        stacks can be found at the OS website:
      </p>

      <ul>
        <li><a href="http://www.ordnancesurvey.co.uk/oswebsite/web-services/os-openspace/api/index.html">Openspace </a> - a free service with limited set of map stacks and resolutions
        </li>
        <li>
          <a href="http://www.ordnancesurvey.co.uk/oswebsite/web-services/os-openspace/pro/index.html">Openspace Pro</a> - a paid for service with greater range of resolutions and two different stacks
        </li>
      </ul>

      <p>
        When creating the map stack, the following 'enum' values can be used for the stack type:
      </p>
      <ul>
        <li><code>OSF</code>: Openspace free (the default)</li>
        <li><code>OSP</code>: Openspace Pro</li>
        <li><code>OSCS</code>: Openspace Pro Consistently Styled</li>
      </ul>
    </section>
    <footer>
      <p>
        <small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small>
      </p>
    </footer>
  </div>
  <!--[if !IE]>
  <script>fixScale(document);</script>
  <![endif]-->


  <!-- 3rd party dependencies -->
  <script type="text/javascript" src="https://raw.github.com/okfn/recline/master/vendor/jquery/1.7.1/jquery.js"></script>
  <script type="text/javascript" src="https://raw.github.com/okfn/recline/master/vendor/underscore/1.4.2/underscore.js"></script>
  <script type="text/javascript" src="https://raw.github.com/okfn/recline/master/vendor/backbone/0.9.2/backbone.js"></script>
  <script type="text/javascript" src="https://raw.github.com/okfn/recline/master/vendor/mustache/0.5.0-dev/mustache.js"></script>
  <script type="text/javascript" src="https://raw.github.com/okfn/recline/master/vendor/bootstrap/2.0.2/bootstrap.js"></script>

  <!-- Recline -->
  <script type="text/javascript" src="https://raw.github.com/okfn/recline/master/dist/recline.js"></script>

  <!-- OS Mp View Deps -->
  <script type="text/javascript" src="vendor/openlayers/2.12/OpenLayers.js"></script>
  <script type="text/javascript" src="src/view.osmap.js"></script>

  <script type="text/javascript">

    var data = [
      {name:'Beddington Park', address:'Church Road', ward:'Beddington North', area:4039.859, perimeter:464.361, easting:529045.924, northing:165372.031},
      {name:'Benhill Rec', address:'Benhill Road', ward:'Sutton Central', area:4106.085, perimeter:264.466, easting:526684.632, northing:164794.199},
      {name:'Carshalton Park', address:'Ruskin Road', ward:'Carshalton Central', area:3613.636, perimeter:214.241, easting:528009.573, northing:164145.634},
      {name:'Cheam Rec', address:'Tudor Close', ward:'Cheam', area:472.949, perimeter:108.399, easting:523875.051, northing:163959.938},
      {name:'Collingwood Rec', address:'Collingwood Road', ward:'Sutton West', area:677.973, perimeter:160.886, easting:525212.291, northing:164714.052},
      {name:'Corrigan Avenue Rec', address:'Corrigan Avenue', ward:'Carshalton South & Clockhouse', area:2030.604, perimeter:239.995, easting:528217.643, northing:160094.234},
      {name:'Cuddington Rec', address:'St Claire Drive', ward:'Nonsuch', area:542.124, perimeter:131.832, easting:522523.247, northing:165147.789},
      {name:'Dale Park', address:'Dale Park Avenue', ward:'The Wrythe', area:512.746, perimeter:100.362, easting:527836.489, northing:165809.453},
      {name:'Dorchester Road Playing Field', address:'Dorchester Road', ward:'Worcester Park', area:1990.387, perimeter:187.476, easting:523303.829, northing:166081.489},
      {name:'Hamilton Avenue Rec', address:'Hamilton Avenue', ward:'Stonecot', area:557.535, perimeter:117.715, easting:524703.7, northing:165423.267}
    ];


    var dataset = new recline.Model.Dataset({
      records:data
    });

    var $el = $('#mapview');
    var map = new recline.View.OSMap({
      model:dataset,
      state:{
        oskey:'CC19DCDCAA577402E0405F0ACA603788',
        autoZoom:true,
        theme:'vendor/openlayers/theme/dark/'
      }
    });
    $el.append(map.el);
    map.render();
    map.show();

  </script>

</body>
</html>